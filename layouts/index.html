{{ define "main" }}
<div class="row">
    <div class="col-12">
        {{ if .Site.Params.showHeroSection }}
        <div class="hero-section mb-5">
            <h1 class="display-4">{{ .Site.Title }}</h1>
            <p class="lead">{{ .Site.Params.description }}</p>
        </div>
        {{ end }}
        
        <h2 class="mb-4">{{ i18n "latestPosts" }}</h2>
        
        <div class="posts-list">
            {{ $paginator := .Paginate (where site.RegularPages "Section" "posts") }}
            {{ range $paginator.Pages }}
            <article class="blog-post">
                <h3 class="post-title">
                    <a href="{{ .Permalink }}">{{ .Title }}</a>
                </h3>
                
                <div class="post-meta">
                    <span class="meta-item">
                        <i class="bi bi-calendar"></i>
                        <time datetime="{{ .Date.Format "2006-01-02" }}">
                            {{ .Date.Format (.Site.Params.dateFormat | default "January 2, 2006") }}
                        </time>
                    </span>
                    
                    {{ if .Site.Params.showReadingTime }}
                    <span class="meta-item">
                        <i class="bi bi-clock"></i>
                        {{ .ReadingTime }} {{ i18n "minRead" }}
                    </span>
                    {{ end }}
                    
                    {{ with .Params.categories }}
                    <span class="meta-item">
                        <i class="bi bi-folder"></i>
                        {{ range $i, $e := . }}
                            {{- if $i -}}, {{ end }}
                            <a href="{{ "categories/" | relLangURL }}{{ . | urlize }}">{{ . }}</a>
                        {{- end }}
                    </span>
                    {{ end }}
                </div>
                
                <div class="post-content">
                    {{ if .Params.image }}
                    <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}" class="img-fluid mb-3">
                    {{ end }}
                    
                    {{ if .Description }}
                        {{ .Description }}
                    {{ else }}
                        {{ .Summary }}
                    {{ end }}
                </div>
                
                <a href="{{ .Permalink }}" class="read-more">
                    {{ i18n "readMore" }} <i class="bi bi-arrow-right"></i>
                </a>
            </article>
            {{ end }}
        </div>
        
        {{ if gt $paginator.TotalPages 1 }}
        <nav aria-label="{{ i18n "pagination" }}">
            <ul class="pagination">
                {{ if $paginator.HasPrev }}
                <li class="page-item">
                    <a class="page-link" href="{{ $paginator.Prev.URL }}" aria-label="{{ i18n "previous" }}">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                {{ else }}
                <li class="page-item disabled">
                    <span class="page-link">&laquo;</span>
                </li>
                {{ end }}
                
                {{ range $paginator.Pagers }}
                <li class="page-item{{ if eq . $paginator }} active{{ end }}">
                    <a class="page-link" href="{{ .URL }}">{{ .PageNumber }}</a>
                </li>
                {{ end }}
                
                {{ if $paginator.HasNext }}
                <li class="page-item">
                    <a class="page-link" href="{{ $paginator.Next.URL }}" aria-label="{{ i18n "next" }}">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
                {{ else }}
                <li class="page-item disabled">
                    <span class="page-link">&raquo;</span>
                </li>
                {{ end }}
            </ul>
        </nav>
        {{ end }}
    </div>
</div>

<!-- Generate search index for home page -->
{{ if .Site.Params.enableSearch }}
{{ $searchIndex := slice }}
{{ range where .Site.RegularPages "Type" "in" (slice "posts" "post") }}
    {{ $searchIndex = $searchIndex | append (dict 
        "uri" .Permalink 
        "title" .Title 
        "content" (.Plain | truncate 500) 
        "tags" .Params.tags 
        "categories" .Params.categories
        "date" .Date
    ) }}
{{ end }}
<script>
    window.searchIndex = {{ $searchIndex | jsonify }};
</script>
{{ end }}
{{ end }}